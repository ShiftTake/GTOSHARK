<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GTO Shark â€“ Dashboard</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root {
      --bg: #0b1220;
      --card: #1e2639;
      --ink: #e2e8f0;
      --lock: #f87171;
      --allow: #22c55e;
    }

    body {
      background: var(--bg);
      color: var(--ink);
      font-family: 'Inter', sans-serif;
    }

    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: transform .2s ease;
    }
    .card:hover {
      transform: translateY(-3px);
    }
    .locked {
      opacity: 0.4;
    }
    .btn {
      margin-top: 12px;
      padding: 10px 20px;
      display: inline-block;
      border-radius: 8px;
      font-weight: bold;
      background: #4f46e5;
      color: white;
    }
    .logout {
      margin-top: 20px;
      background: #ef4444;
    }
  </style>
</head>

<body class="min-h-screen p-8">

  <h1 class="text-3xl font-bold mb-6">Welcome to GTO Shark</h1>
  <p id="subStatus" class="mb-8 text-lg"></p>

  <div id="games" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>

  <button class="btn logout" onclick="logout()">Logout</button>

  <script>
    // --- FIREBASE CONFIG ---
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_DOMAIN",
      projectId: "YOUR_PROJECT",
      storageBucket: "YOUR_BUCKET",
      messagingSenderId: "YOUR_SENDER",
      appId: "YOUR_APPID"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const gameLinks = {
      poker: "gttpractice.html",
      blackjack: "blackjacktrainer.html",
      baccarat: "bactrainer198.html",
      roulette: "roulettetrainer.html"
    };

    function logout() {
      auth.signOut().then(() => {
        window.location.href = "login.html";
      });
    }

    auth.onAuthStateChanged(async (user) => {
      if (!user) {
        window.location.href = "login.html";
        return;
      }

      const ref = db.collection("users").doc(user.uid);
      const docSnap = await ref.get();

      if (!docSnap.exists) {
        document.getElementById("subStatus").innerText =
          "No account found. Please contact support.";
        return;
      }

      const data = docSnap.data();
      const access = data.subscription || {};

      let active = false;
      let html = "";

      Object.keys(gameLinks).forEach(key => {
        const unlocked = access[key] === true;
        active = active || unlocked;

        html += `
        <div class="card ${unlocked ? "" : "locked"}">
          <h2 class="text-xl font-bold mb-2">
            ${key.charAt(0).toUpperCase() + key.slice(1)}
          </h2>
          <p>${unlocked ? "<span style='color:var(--allow)'>Unlocked</span>" : "<span style='color:var(--lock)'>Locked</span>"}</p>
          ${
            unlocked
              ? `<a class="btn" href="${gameLinks[key]}">Launch</a>`
              : `<span class="text-sm mt-3 block">Purchase Required</span>`
          }
        </div>`;
      });

      document.getElementById("games").innerHTML = html;

      document.getElementById("subStatus").innerText =
        active ? "Your subscription is active." : "No active subscriptions found.";
    });
  </script>

</body>
</html>

