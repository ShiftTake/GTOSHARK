<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>American Roulette Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050816;
            --bg-elevated: #0b1020;
            --panel: #111827;
            --accent: #6366f1;
            --accent-soft: #4f46e5;
            --accent-strong: #a855f7;
            --text-main: #e5e7eb;
            --text-muted: #9ca3af;
        }

        body {
            font-family: 'Inter', sans-serif;
            background:
                radial-gradient(circle at 0% 0%, #1d1b4c 0, #050816 45%, #020617 100%);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .shell-card {
            background: radial-gradient(circle at top, #111827 0, #020617 70%);
            border-radius: 1.5rem;
            border: 1px solid rgba(148, 163, 184, 0.4);
            box-shadow:
                0 24px 80px rgba(15, 23, 42, 0.95),
                0 0 0 1px rgba(15, 23, 42, 0.6);
        }

        .section-label {
            letter-spacing: 0.22em;
        }

        /* Scoreboard */
        .score-pill {
            border-radius: 1.25rem;
            background: radial-gradient(circle at top left, rgba(76, 81, 191, 0.25), rgba(15, 23, 42, 0.95));
        }

        /* Minimal premium roulette wheel */
        .wheel-wrapper {
            position: relative;
            width: 180px;
            height: 180px;
            margin: 0 auto;
        }

        .wheel-outline {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background:
                conic-gradient(
                    from 0deg,
                    rgba(148, 163, 184, 0.9),
                    rgba(79, 70, 229, 0.9),
                    rgba(148, 163, 184, 0.9),
                    rgba(129, 140, 248, 0.9),
                    rgba(148, 163, 184, 0.9)
                );
            padding: 8px;
            box-shadow:
                0 0 35px rgba(79, 70, 229, 0.55),
                0 12px 40px rgba(15, 23, 42, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .roulette-wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background:
                radial-gradient(circle at 30% 0%, rgba(148, 163, 184, 0.35) 0, rgba(15, 23, 42, 1) 55%),
                radial-gradient(circle at 70% 110%, rgba(79, 70, 229, 0.4) 0, rgba(15, 23, 42, 1) 55%);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .roulette-wheel-inner {
            width: 72%;
            height: 72%;
            border-radius: 50%;
            background:
                radial-gradient(circle, #020617 0, #020617 35%, #0b1120 100%);
            border: 1px solid rgba(148, 163, 184, 0.45);
            display: flex;
            align-items: center;
            justify-content: center;
            transform: rotate(0deg);
            transition: transform 4s cubic-bezier(0.2, 0.7, 0.4, 1);
        }

        .roulette-center {
            width: 28%;
            height: 28%;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 20%, #1d4ed8 0, #020617 90%);
            box-shadow:
                0 0 12px rgba(59, 130, 246, 0.8),
                inset 0 0 10px rgba(15, 23, 42, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .roulette-pointer {
            position: absolute;
            top: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 18px solid #facc15;
            filter: drop-shadow(0 0 8px rgba(250, 204, 21, 0.7));
            z-index: 20;
        }

        .winning-number {
            font-size: 2.5rem;
            font-weight: 900;
            text-shadow: 0 0 16px rgba(129, 140, 248, 0.8);
        }

        /* Chip / bet controls */
        .pill-input {
            border-radius: 999px;
        }

        .bet-button,
        .number-bet-btn {
            transition: transform 0.1s, box-shadow 0.15s, background-color 0.2s;
        }

        .bet-button {
            border-radius: 999px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.7);
        }

        .bet-button:active,
        .number-bet-btn:active {
            transform: scale(0.96);
        }

        .bet-button:disabled,
        .number-bet-btn:disabled {
            opacity: 0.45;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Number color tags */
        .num-red { background: linear-gradient(135deg, #f97373, #b91c1c); }
        .num-black { background: linear-gradient(135deg, #020617, #1f2937); }
        .num-green { background: linear-gradient(135deg, #22c55e, #059669); }

        /* Active bet highlight */
        .bet-active {
            box-shadow:
                0 0 0 2px #facc15,
                0 0 16px rgba(250, 204, 21, 0.75);
            transform: scale(1.04);
        }

        .metric-card {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 1rem;
            border: 1px solid rgba(148, 163, 184, 0.4);
        }
    </style>
</head>
<body>

    <div class="w-full max-w-5xl shell-card p-8 sm:p-10">
        <!-- Header -->
        <div class="flex flex-col gap-3 mb-8 text-center">
            <div class="text-xs sm:text-sm font-semibold text-indigo-400 section-label">
                GTO SHARK · ROULETTE MODULE
            </div>
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-slate-50 tracking-tight">
                Simulate Roulette. <span class="text-indigo-400">Quantify Risk.</span>
            </h1>
            <p class="text-sm sm:text-base text-slate-400 max-w-2xl mx-auto">
                Spin an American Roulette wheel, place straight-up or outside bets, and visualize the impact on your bankroll under the same theme as your Baccarat simulator.
            </p>
        </div>

        <!-- Scoreboard and Bankroll -->
        <div class="flex flex-col md:flex-row justify-between gap-4 items-center mb-8 px-5 py-4 score-pill border border-slate-700">
            <div class="flex flex-col items-start">
                <span class="text-xs uppercase tracking-widest text-slate-400">Bankroll</span>
                <span class="text-2xl font-bold text-slate-50">
                    <span id="bankroll">1000.00</span>
                </span>
            </div>
            <div class="flex flex-col items-start">
                <span class="text-xs uppercase tracking-widest text-slate-400">Current Bet</span>
                <span class="text-2xl font-bold text-indigo-300">
                    <span id="current-bet-display">0.00</span>
                    <span class="text-xs sm:text-sm text-slate-400 block mt-1">
                        <span id="current-bet-type">None</span>
                    </span>
                </span>
            </div>
            <div class="flex flex-col items-start">
                <span class="text-xs uppercase tracking-widest text-slate-400">Winning Number</span>
                <span class="text-2xl font-bold text-yellow-300 font-mono">
                    <span id="winning-number-display">-</span>
                </span>
            </div>
        </div>

        <!-- Wheel Area -->
        <div class="text-center mb-8 p-6 bg-slate-900/80 rounded-2xl shadow-lg border border-slate-700">
            <div class="flex flex-col items-center gap-3 mb-4">
                <h2 class="text-xl sm:text-2xl font-bold text-indigo-200">
                    Minimal Roulette Wheel
                </h2>
                <p class="text-xs sm:text-sm text-slate-400 max-w-md">
                    A clean, data-focused wheel visualization aligned with the GTO Shark interface.
                </p>
            </div>

            <div class="wheel-wrapper">
                <div class="roulette-pointer"></div>
                <div class="wheel-outline">
                    <div class="roulette-wheel">
                        <div id="wheel-inner" class="roulette-wheel-inner">
                            <div class="roulette-center">
                                <span id="result-text" class="winning-number text-slate-50">
                                    SPIN
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="result-message"
                 class="text-center text-base sm:text-lg font-semibold mt-6 text-yellow-300 min-h-[28px]">
                Place your bet to begin this spin.
            </div>
        </div>

        <!-- Betting Controls -->
        <div class="bg-slate-900/80 border border-slate-700 p-6 rounded-2xl shadow-inner mb-8">
            <div class="flex flex-col sm:flex-row gap-2 items-start sm:items-center justify-between mb-4">
                <h3 class="text-lg sm:text-xl font-bold text-slate-100 flex items-center gap-2">
                    Betting Console
                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[0.65rem] font-semibold bg-indigo-500/10 text-indigo-300 border border-indigo-500/40">
                        American Layout
                    </span>
                </h3>
                <span class="text-[0.7rem] sm:text-xs text-slate-400">
                    Set your stake, choose a number or outside bet, then spin the wheel.
                </span>
            </div>

            <div class="flex flex-col sm:flex-row gap-3 mb-5">
                <input
                    type="number"
                    id="bet-amount"
                    value="10"
                    min="1"
                    step="1"
                    class="flex-grow p-3 pill-input text-base bg-slate-950/70 border border-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-slate-100 placeholder:text-slate-500"
                    placeholder="Enter bet amount">
                <button
                    onclick="setBet(10)"
                    class="w-full sm:w-auto px-4 py-2 pill-input bg-slate-800 hover:bg-slate-700 border border-slate-600 text-slate-100 text-sm font-semibold transition duration-150">
                    Quick 10
                </button>
                <button
                    onclick="setBet(50)"
                    class="w-full sm:w-auto px-4 py-2 pill-input bg-slate-800 hover:bg-slate-700 border border-slate-600 text-slate-100 text-sm font-semibold transition duration-150">
                    Quick 50
                </button>
            </div>

            <!-- Straight Up Number Grid -->
            <h4 class="text-sm sm:text-lg font-semibold mt-4 mb-2 text-slate-200">
                Straight Up Numbers <span class="text-slate-400 text-xs font-normal">(35 : 1)</span>
            </h4>
            <div id="straight-up-buttons" class="grid grid-cols-9 sm:grid-cols-12 gap-1.5 mb-5">
                <!-- Number buttons generated by JavaScript -->
            </div>

            <!-- Outside Bets -->
            <h4 class="text-sm sm:text-lg font-semibold mt-4 mb-2 text-slate-200">
                Outside Bets <span class="text-slate-400 text-xs font-normal">(1 : 1 or 2 : 1)</span>
            </h4>
            <div class="grid grid-cols-2 sm:grid-cols-6 gap-3 mb-6">
                <button
                    onclick="placeBet('Red')"
                    class="bet-button p-2 text-xs sm:text-sm font-bold num-red text-white hover:opacity-90">
                    Red (1 : 1)
                </button>
                <button
                    onclick="placeBet('Black')"
                    class="bet-button p-2 text-xs sm:text-sm font-bold num-black text-white hover:opacity-90">
                    Black (1 : 1)
                </button>
                <button
                    onclick="placeBet('Odd')"
                    class="bet-button p-2 text-xs sm:text-sm font-bold bg-slate-700 text-white hover:bg-slate-600">
                    Odd (1 : 1)
                </button>
                <button
                    onclick="placeBet('Even')"
                    class="bet-button p-2 text-xs sm:text-sm font-bold bg-slate-700 text-white hover:bg-slate-600">
                    Even (1 : 1)
                </button>
                <button
                    onclick="placeBet('FirstDoz', '1-12')"
                    class="bet-button p-2 text-xs sm:text-sm font-bold bg-indigo-500 text-white hover:bg-indigo-400">
                    1st Dozen (2 : 1)
                </button>
                <button
                    onclick="placeBet('SecondDoz', '13-24')"
                    class="bet-button p-2 text-xs sm:text-sm font-bold bg-indigo-500 text-white hover:bg-indigo-400">
                    2nd Dozen (2 : 1)
                </button>
                <button
                    onclick="placeBet('ThirdDoz', '25-36')"
                    class="bet-button p-2 text-xs sm:text-sm font-bold bg-indigo-500 text-white hover:bg-indigo-400 col-span-2 sm:col-span-1">
                    3rd Dozen (2 : 1)
                </button>
            </div>

            <div class="flex flex-col sm:flex-row gap-4">
                <button
                    id="clear-bet-btn"
                    onclick="clearBet()"
                    class="flex-grow p-3 text-sm font-bold rounded-full bg-slate-700 text-slate-50 hover:bg-slate-600">
                    Clear Bet
                </button>
                <button
                    id="spin-btn"
                    onclick="spinWheel()"
                    class="bet-button flex-grow p-3 text-lg sm:text-xl font-bold rounded-full bg-gradient-to-r from-amber-400 to-amber-300 text-slate-900 hover:from-amber-300 hover:to-amber-200 disabled:opacity-50 transition duration-150 shadow-md">
                    SPIN
                </button>
            </div>
        </div>

        <!-- Risk Metric Display -->
        <div class="p-6 bg-slate-900/90 rounded-2xl shadow-xl border border-rose-500/50">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-5">
                <h3 class="text-lg sm:text-xl font-bold text-slate-100">
                    Risk Management Metrics (American Roulette)
                </h3>
                <span class="text-[0.7rem] uppercase tracking-[0.22em] text-rose-300">
                    House Edge Snapshot
                </span>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-center">
                <div class="metric-card p-3">
                    <div class="text-xs text-slate-400 mb-1">Inside Bets (e.g., Straight Up) EV</div>
                    <div id="ev-inside" class="text-lg font-mono text-rose-400">-5.26%</div>
                </div>
                <div class="metric-card p-3">
                    <div class="text-xs text-slate-400 mb-1">Outside Bets (e.g., Red / Black) EV</div>
                    <div id="ev-outside" class="text-lg font-mono text-rose-400">-5.26%</div>
                </div>
                <div class="metric-card p-3">
                    <div class="text-xs text-slate-400 mb-1">Worst Bet: Five-Number (0, 00, 1, 2, 3)</div>
                    <div id="ev-worst" class="text-lg font-mono text-rose-400">-7.89%</div>
                </div>
            </div>

            <p class="mt-4 text-xs sm:text-sm text-slate-400 text-center max-w-2xl mx-auto">
                The house edge on almost all American Roulette bets is approximately 5.26%. Over many spins,
                you are expected to lose about 5.26 units for every 100 wagered.
            </p>
        </div>
    </div>

    <script>
        // --- Core Game State ---
        let bankroll = 1000.00;
        let betAmount = 0;
        let currentBetType = null;
        let currentBetValue = null;
        let gameActive = false;

        const AMERICAN_WHEEL = {
            '0': 'green', '00': 'green',
            '1': 'red', '2': 'black', '3': 'red', '4': 'black', '5': 'red',
            '6': 'black', '7': 'red', '8': 'black', '9': 'red', '10': 'black',
            '11': 'black', '12': 'red', '13': 'black', '14': 'red', '15': 'black',
            '16': 'red', '17': 'black', '18': 'red', '19': 'red', '20': 'black',
            '21': 'red', '22': 'black', '23': 'red', '24': 'black', '25': 'red',
            '26': 'black', '27': 'red', '28': 'black', '29': 'black', '30': 'red',
            '31': 'black', '32': 'red', '33': 'black', '34': 'red', '35': 'black', '36': 'red'
        };
        const NUMBERS = Object.keys(AMERICAN_WHEEL); // ['0', '00', '1', ..., '36']
        const WHEEL_SECTIONS = 38; // 38 pockets in American Roulette

        // Expected Values (EV) for American Roulette (House Edge)
        const EV = {
            'Standard': -0.0526, // -5.26% for most bets
            'FiveNumber': -0.0789 // -7.89% for 5-number bet (0, 00, 1, 2, 3)
        };

        // --- Utility Functions ---

        /**
         * Generates the 38 number buttons for Straight Up bets.
         */
        function initNumberButtons() {
            const container = document.getElementById('straight-up-buttons');
            container.innerHTML = '';

            // Order numbers: 0, 00, then 1-36
            const orderedNumbers = ['0', '00', ...NUMBERS.filter(n => n !== '0' && n !== '00')];

            orderedNumbers.forEach(num => {
                const color = AMERICAN_WHEEL[num];
                let bgColorClass = `num-${color}`;

                const btn = document.createElement('button');
                btn.textContent = num;
                btn.setAttribute('data-number', num);
                btn.className = `number-bet-btn p-2 text-[0.65rem] sm:text-xs font-bold rounded-md text-white hover:opacity-85 transition duration-100 ${bgColorClass}`;
                btn.onclick = () => placeBet('StraightUp', num);
                container.appendChild(btn);
            });
        }

        /**
         * Highlights the active bet.
         */
        function updateBetHighlights() {
            document.querySelectorAll('.number-bet-btn, .bet-button').forEach(btn => {
                btn.classList.remove('bet-active');
            });

            if (currentBetType === 'StraightUp' && currentBetValue) {
                const activeBtn = document.querySelector(`.number-bet-btn[data-number="${currentBetValue}"]`);
                if (activeBtn) activeBtn.classList.add('bet-active');
            } else if (currentBetType) {
                const outsideBtn = document.querySelector(`[onclick*="placeBet('${currentBetType}'"]`);
                if (outsideBtn) outsideBtn.classList.add('bet-active');
            }
        }

        /**
         * Updates the main UI elements including bankroll and current bet.
         */
        function updateUI() {
            document.getElementById('bankroll').textContent = bankroll.toFixed(2);
            document.getElementById('current-bet-display').textContent = betAmount.toFixed(2);
            document.getElementById('current-bet-type').textContent = currentBetType
                ? (currentBetType + (currentBetValue ? ` (${currentBetValue})` : ''))
                : 'None';

            const spinButton = document.getElementById('spin-btn');
            const allBetButtons = document.querySelectorAll('.bet-button, .number-bet-btn');
            const betInput = document.getElementById('bet-amount');

            // Control spin button state
            spinButton.disabled = gameActive || betAmount <= 0;

            // Control betting buttons/input state
            betInput.disabled = gameActive;
            allBetButtons.forEach(btn => {
                const isPlacement = btn.id !== 'spin-btn' && btn.id !== 'clear-bet-btn';
                if (isPlacement) {
                    btn.disabled = gameActive || betAmount > 0;
                }
            });

            document.getElementById('clear-bet-btn').disabled = gameActive || betAmount === 0;

            // Apply warning if bankroll is low
            document.getElementById('bankroll').classList.toggle('text-rose-400', bankroll < 50);

            updateBetHighlights();
        }

        /**
         * Sets the bet amount input field value.
         * @param {number} amount - The amount to set.
         */
        function setBet(amount) {
            document.getElementById('bet-amount').value = amount;
            updateUI();
        }

        /**
         * Clears the current bet.
         */
        function clearBet() {
            if (gameActive || betAmount === 0) return;

            // Return the bet amount to the bankroll
            if (currentBetType) {
                bankroll += betAmount;
            }
            betAmount = 0;
            currentBetType = null;
            currentBetValue = null;
            showMessage('Bet cleared. Choose your next wager.');
            updateUI();
        }

        /**
         * Places a bet and dedicates the bankroll amount.
         * @param {string} type - 'StraightUp', 'Red', 'Black', 'Odd', 'Even', 'FirstDoz', etc.
         * @param {string} [value] - Specific value for StraightUp or Dozen bets.
         */
        function placeBet(type, value = null) {
            if (gameActive || currentBetType) {
                showMessage('Please clear your current bet or wait for the round to finish.');
                return;
            }

            const inputAmount = parseFloat(document.getElementById('bet-amount').value);

            if (isNaN(inputAmount) || inputAmount <= 0) {
                showMessage('Enter a valid bet amount.');
                return;
            }
            if (inputAmount > bankroll) {
                showMessage('Insufficient bankroll for this bet.');
                return;
            }

            betAmount = inputAmount;
            currentBetType = type;
            currentBetValue = value;
            bankroll -= betAmount;

            let message = `Wagered ${betAmount.toFixed(2)} on ${type}`;
            if (value) message += ` (${value})`;

            showMessage(message + '. Press SPIN to resolve.');
            updateUI();
        }

        /**
         * Spins the wheel and determines the winning number.
         */
        async function spinWheel() {
            if (gameActive || betAmount <= 0) return;

            gameActive = true;
            document.getElementById('spin-btn').disabled = true;
            showMessage('Ball in motion...');

            // 1. Determine winning number
            const winningIndex = Math.floor(Math.random() * WHEEL_SECTIONS); // 0 to 37
            const winningNumber = NUMBERS[winningIndex];
            const winningColor = AMERICAN_WHEEL[winningNumber];

            // 2. Animate the wheel
            const wheel = document.getElementById('wheel-inner');
            const rotations = 5; // full rotations
            const targetAngle = winningIndex * (360 / WHEEL_SECTIONS);
            const finalRotation = (rotations * 360) + (360 - targetAngle) + (Math.random() * 5 - 2.5);

            wheel.style.transition = 'transform 4s cubic-bezier(0.2, 0.7, 0.4, 1)';
            wheel.style.transform = `rotate(${finalRotation}deg)`;
            document.getElementById('result-text').textContent = '';

            await new Promise(r => setTimeout(r, 4500));

            wheel.style.transition = 'none';

            // 3. Display Result
            document.getElementById('winning-number-display').textContent = winningNumber;
            document.getElementById('result-text').textContent = winningNumber;
            document.getElementById('result-text').className =
                `winning-number ${
                    winningColor === 'red'
                        ? 'text-rose-400'
                        : winningColor === 'black'
                        ? 'text-slate-100'
                        : 'text-emerald-400'
                }`;

            // 4. Calculate Payout
            calculateWinnings(winningNumber);

            gameActive = false;
            updateUI();
        }

        /**
         * Calculates the payout based on the winning number and the placed bet.
         * @param {string} winningNumber - The number that won.
         */
        function calculateWinnings(winningNumber) {
            let winnings = 0;
            let resultMessage = '';
            let won = false;
            const winningNum = parseInt(winningNumber) || winningNumber; // '0', '00' or number
            const winningColor = AMERICAN_WHEEL[winningNumber];

            const betType = currentBetType;
            const betValue = currentBetValue;
            const betAmountWon = betAmount;

            // Payout logic
            switch (betType) {
                case 'StraightUp': // 35 : 1
                    if (betValue === winningNumber) {
                        winnings = betAmountWon * 35;
                        won = true;
                    }
                    break;
                case 'Red': // 1 : 1
                    if (winningColor === 'red') {
                        winnings = betAmountWon * 1;
                        won = true;
                    }
                    break;
                case 'Black': // 1 : 1
                    if (winningColor === 'black') {
                        winnings = betAmountWon * 1;
                        won = true;
                    }
                    break;
                case 'Odd': // 1 : 1 (0 and 00 are neither)
                    if (typeof winningNum === 'number' && winningNum % 2 !== 0) {
                        winnings = betAmountWon * 1;
                        won = true;
                    }
                    break;
                case 'Even': // 1 : 1 (0 and 00 are neither)
                    if (typeof winningNum === 'number' && winningNum % 2 === 0) {
                        winnings = betAmountWon * 1;
                        won = true;
                    }
                    break;
                case 'FirstDoz': // 1–12, 2 : 1
                    const numDoz1 = parseInt(winningNumber);
                    if (numDoz1 >= 1 && numDoz1 <= 12) {
                        winnings = betAmountWon * 2;
                        won = true;
                    }
                    break;
                case 'SecondDoz': // 13–24, 2 : 1
                    const numDoz2 = parseInt(winningNumber);
                    if (numDoz2 >= 13 && numDoz2 <= 24) {
                        winnings = betAmountWon * 2;
                        won = true;
                    }
                    break;
                case 'ThirdDoz': // 25–36, 2 : 1
                    const numDoz3 = parseInt(winningNumber);
                    if (numDoz3 >= 25 && numDoz3 <= 36) {
                        winnings = betAmountWon * 2;
                        won = true;
                    }
                    break;
                default:
                    resultMessage = `No valid bet placed. Winning number is ${winningNumber}.`;
                    showMessage(resultMessage);
                    clearBet();
                    return;
            }

            if (won) {
                bankroll += betAmountWon + winnings; // Return original bet + winnings
                resultMessage =
                    `Win: ${winnings.toFixed(2)}. Total returned this spin: ${(betAmountWon + winnings).toFixed(2)}.`;
                showMessage(resultMessage);
            } else {
                resultMessage =
                    `Loss: ${betAmountWon.toFixed(2)}. Winning number was ${winningNumber}.`;
                showMessage(resultMessage);
            }

            // Reset bet state for the next round
            betAmount = 0;
            currentBetType = null;
            currentBetValue = null;
        }

        /**
         * Utility to show a message in the result box.
         * @param {string} text - The message to show.
         */
        function showMessage(text) {
            const el = document.getElementById('result-message');
            el.className = 'text-center text-base sm:text-lg font-semibold mt-6 text-yellow-300 min-h-[28px]';
            el.textContent = text;
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initNumberButtons();
            updateUI();

            // Input change listener
            const betInput = document.getElementById('bet-amount');
            betInput.addEventListener('change', () => {
                let val = parseFloat(betInput.value);
                if (val <= 0 || isNaN(val)) {
                    val = 1;
                }
                betInput.value = val.toFixed(0);
                updateUI();
            });

            // Display fixed EV metrics
            document.getElementById('ev-inside').textContent = `${(EV.Standard * 100).toFixed(2)}%`;
            document.getElementById('ev-outside').textContent = `${(EV.Standard * 100).toFixed(2)}%`;
            document.getElementById('ev-worst').textContent = `${(EV.FiveNumber * 100).toFixed(2)}%`;
        });
    </script>
</body>
</html>
