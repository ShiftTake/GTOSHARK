<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GTO Shark - Full Advanced Range Chart</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --primary: #4f46e5; /* indigo-600 */
      --background: #0f172a; /* slate-900 */
      --card: #1e293b; /* slate-800 */
      --text: #e2e8f0; /* slate-200 */
      --teal-600: #0d9488;
      --red-500: #ef4444;
      --amber-500: #f59e0b;
      --slate-700: #334155;
    }
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--background);
      color: var(--text);
      line-height: 1.6;
    }
    .solver-card {
      background-color: var(--card);
      border: 1px solid #334155;
      border-radius: 0.75rem;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
    }
    .hand-matrix-grid {
      display: grid;
      grid-template-columns: repeat(13, 1fr);
      grid-template-rows: repeat(13, 1fr);
      aspect-ratio: 1 / 1;
      max-width: 560px;
      margin: 0 auto;
    }
    .hand-cell {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      border: 1px solid #1e293b;
      transition: background 0.16s ease, transform 0.08s ease;
      cursor: pointer;
      position: relative;
      user-select: none;
      color: #fff;
    }
    .hand-cell:hover { transform: scale(1.06); z-index: 2; }

    /* Heat legend */
    .legend {
      height: 12px;
      border-radius: 9999px;
      background: linear-gradient(90deg,
        #334155 0%, /* slate for 0% (not in range) */
        #ef4444 10%, /* red */
        #f59e0b 50%, /* amber */
        #4f46e5 100% /* indigo */
      );
      border: 1px solid #1f2937;
    }
    .legend-labels {
      display: flex; justify-content: space-between; font-size: 0.75rem; color: #94a3b8;
    }

    /* Tooltip */
    .tooltip {
      position: fixed;
      pointer-events: none;
      background: rgba(15,23,42,0.95);
      color: #e2e8f0;
      border: 1px solid #1f2937;
      border-radius: 0.5rem;
      padding: 6px 8px;
      font-size: 12px;
      z-index: 50;
      transform: translate(-50%, -120%);
      white-space: nowrap;
      display: none;
    }

    /* Toggle */
    .switch { position: relative; display: inline-block; width: 44px; height: 24px; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #475569; transition: .2s; border-radius: 9999px; }
    .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .2s; border-radius: 50%; }
    input:checked + .slider { background-color: #4f46e5; }
    input:checked + .slider:before { transform: translateX(20px); }
  </style>
</head>
<body class="p-8">
  <header class="flex justify-between items-center mb-8">
    <h1 class="text-4xl font-extrabold text-indigo-400">GTO Shark - Advanced Poker Range Solver</h1>
    <a href="index.html" class="text-indigo-400 hover:text-white transition text-sm">Back to Home</a>
  </header>

  <div class="flex flex-col lg:flex-row gap-8">
    <div class="lg:w-1/3 space-y-6">
      <div class="solver-card p-6">
        <h2 class="text-xl font-bold mb-4 text-white">Scenario Options</h2>

        <label class="block mb-2 font-semibold">Game Type</label>
        <select id="gameType" class="w-full p-2 rounded bg-slate-700">
          <option value="cash">Cash Game</option>
          <option value="mtt">MTT</option>
        </select>

        <label class="block mt-4 mb-2 font-semibold">Table Position</label>
        <select id="position" class="w-full p-2 rounded bg-slate-700">
          <option value="utg">Under the Gun (UTG)</option>
          <option value="utg1">Under the Gun +1 (UTG+1)</option>
          <option value="utg2">Under the Gun +2 (UTG+2)</option>
          <option value="lj">Lowjack (LJ)</option>
          <option value="hj">Hijack (HJ)</option>
          <option value="co">Cutoff (CO)</option>
          <option value="btn">Button (BTN)</option>
          <option value="sb">Small Blind (SB)</option>
          <option value="bb">Big Blind (BB)</option>
        </select>

        <label class="block mt-4 mb-2 font-semibold">Stack Size (BBs)</label>
        <input id="stackSize" type="number" value="100" min="5" max="250" class="w-full p-2 rounded bg-slate-700">

        <label class="block mt-4 mb-2 font-semibold">Action Type</label>
        <select id="action" class="w-full p-2 rounded bg-slate-700">
          <option value="open">Open Raise</option>
          <option value="call">Call</option>
          <option value="3bet">3-Bet</option>
          <option value="4bet">4-Bet</option>
          <option value="fold">Fold</option>
        </select>

        <div class="mt-4 flex items-center gap-3">
          <label class="switch">
            <input type="checkbox" id="toggleLabels">
            <span class="slider"></span>
          </label>
          <span class="text-sm text-slate-300">Show % labels on cells</span>
        </div>

        <button id="generateBtn" class="mt-6 w-full bg-indigo-600 text-white font-bold p-3 rounded hover:bg-indigo-700">Generate Range</button>
      </div>

      <div class="solver-card p-6">
        <h2 class="text-xl font-bold text-white mb-4">Legend</h2>
        <div class="legend mb-2"></div>
        <div class="legend-labels">
          <span>0%</span>
          <span>50%</span>
          <span>100%</span>
        </div>
        <ul class="space-y-1 text-xs mt-4 text-slate-300">
          <li><b class="text-indigo-300">Indigo</b>: High frequency for the selected action</li>
          <li><b class="text-amber-300">Amber</b>: Medium frequency / mixed</li>
          <li><b class="text-red-300">Red</b>: Low frequency (borderline) — gray means not in range</li>
        </ul>
      </div>
    </div>

    <div class="lg:w-2/3">
      <div class="solver-card p-6">
        <h2 id="scenarioLabel" class="text-2xl font-bold text-indigo-400 mb-4 text-center">Range Visualization</h2>
        <div id="handMatrix" class="hand-matrix-grid"></div>
        <p class="text-sm text-slate-400 mt-4 text-center">Diagonal = Pocket Pairs | Above = Suited | Below = Offsuit</p>
      </div>
    </div>
  </div>

  <div id="tooltip" class="tooltip"></div>

  <footer class="text-center mt-12 text-slate-600 text-xs border-t border-slate-700 pt-4">GTO Shark © 2025. Demonstration tool only.</footer>

  <script>
    const ranks = ['A','K','Q','J','T','9','8','7','6','5','4','3','2'];
    const matrix = document.getElementById('handMatrix');
    const tooltip = document.getElementById('tooltip');

    function getHand(row, col) {
      const r1 = ranks[row], r2 = ranks[col];
      if (row === col) return r1 + r2; // pocket
      return row < col ? `${r2}${r1}s` : `${r1}${r2}o`; // suited / offsuit
    }

    // Hex color helpers
    const hexToRgb = (hex) => hex.replace('#','').match(/.{1,2}/g).map(x=>parseInt(x,16));
    const rgbToHex = (r,g,b) => '#' + [r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('');
    function lerp(a,b,t){ return a + (b-a)*t; }
    function lerpColor(c1, c2, t){
      const [r1,g1,b1] = hexToRgb(c1), [r2,g2,b2] = hexToRgb(c2);
      return rgbToHex(Math.round(lerp(r1,r2,t)), Math.round(lerp(g1,g2,t)), Math.round(lerp(b1,b2,t)));
    }

    // Heatmap scale: gray(0) -> red(~0.1) -> amber(0.5) -> indigo(1)
    function colorScale(p){
      if (p <= 0.02) return '#334155';
      if (p < 0.1) return lerpColor('#334155', '#ef4444', (p-0.02)/0.08);
      if (p < 0.5) return lerpColor('#ef4444', '#f59e0b', (p-0.1)/0.4);
      return lerpColor('#f59e0b', '#4f46e5', (p-0.5)/0.5);
    }

    // Very lightweight pseudo-model to create consistent-looking frequencies
    function baseStrength(row, col){
      // Stronger for high cards & suited & pairs near top-left
      let s = 0.0;
      const suited = row < col; // above diagonal
      const pair = row === col;
      const highness = (12 - Math.min(row, col)) / 12; // A-high -> 1 ... 2-low -> ~0
      s += highness * 0.6;
      if (suited) s += 0.15;
      if (pair) s += 0.25 - (row/24); // AA best, 22 worst
      // Slight penalty as we move to bottom-right (trash hands)
      const distance = (row + col) / 24;
      s -= distance * 0.1;
      return Math.max(0, Math.min(1, s));
    }

    function scenarioAdjust(pos, stack, action, gameType, s){
      // Positional looseness/tightness
      const posAdj = { utg:-0.22, utg1:-0.18, utg2:-0.12, lj:-0.08, hj:-0.03, co:0.06, btn:0.16, sb:0.1, bb:0.05 };
      s += (posAdj[pos] || 0);
      // Short stacks (MTT) push higher 3b/4b frequencies but narrow opens
      if (gameType==='mtt'){
        if (stack < 25){ s += (action==='3bet' || action==='4bet') ? 0.08 : -0.06; }
        if (stack < 15){ s += (action==='open') ? -0.05 : 0.06; }
      }
      // Action-specific shaping
      if (action==='open') s += 0.06;
      if (action==='call') s -= 0.02;
      if (action==='3bet') s += 0.04;
      if (action==='4bet') s += 0.02;
      if (action==='fold') s = 1 - s; // Fold heat = inverse of strength
      return Math.max(0, Math.min(1, s));
    }

    function generateRange(){
      matrix.innerHTML = '';
      const pos = document.getElementById('position').value;
      const stack = parseInt(document.getElementById('stackSize').value, 10);
      const action = document.getElementById('action').value;
      const gameType = document.getElementById('gameType').value;
      const showLabels = document.getElementById('toggleLabels').checked;

      document.getElementById('scenarioLabel').textContent = `${gameType.toUpperCase()} | ${pos.toUpperCase()} | ${stack}BB | ${action.toUpperCase()} RANGE`;

      for (let i=0; i<13; i++){
        for (let j=0; j<13; j++){
          const cell = document.createElement('div');
          const hand = getHand(i, j);
          let p = baseStrength(i, j);
          p = scenarioAdjust(pos, stack, action, gameType, p);
          const bg = colorScale(p);

          cell.className = 'hand-cell';
          cell.style.backgroundColor = bg;
          cell.dataset.freq = p.toFixed(3);
          cell.dataset.hand = hand;
          cell.textContent = showLabels ? `${hand} ${(p*100).toFixed(0)}%` : hand;

          cell.addEventListener('mouseenter', (e)=>{
            tooltip.style.display = 'block';
            tooltip.innerHTML = `<b>${hand}</b> — <span class="text-indigo-300">${(p*100).toFixed(1)}%</span> ${action.toUpperCase()}`;
          });
          cell.addEventListener('mousemove', (e)=>{
            tooltip.style.left = e.pageX + 'px';
            tooltip.style.top = e.pageY + 'px';
          });
          cell.addEventListener('mouseleave', ()=>{ tooltip.style.display = 'none'; });

          matrix.appendChild(cell);
        }
      }
    }

    document.getElementById('generateBtn').addEventListener('click', generateRange);
    document.getElementById('toggleLabels').addEventListener('change', generateRange);
    generateRange();
  </script>
</body>
</html>
